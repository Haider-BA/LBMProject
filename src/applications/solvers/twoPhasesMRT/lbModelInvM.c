#include <stdio.h>
#include <stdlib.h>
#include "data.h"

double** lbModelInvM(const struct lattice lat) {

    double** M;
    
    if(  (lat.d == 2) && (lat.Q == 9)  )  {

	unsigned int i;
	M = (double**)malloc( lat.Q * sizeof(double*) );
	for (i = 0 ; i < lat.Q ; i++) {
	    M[i] = (double*)malloc( lat.Q * sizeof(double) );
	}

	const double c1 = 1.0/9.0,
	    c2 = 1.0 / 6.0,
	    c3 = 1.0 / 4.0;


	
	M[0][0] = c1;
	M[0][1] = -c1;
	M[0][2] = c1;
	M[0][3] = 0;
	M[0][4] = 0;
	M[0][5] = 0;
	M[0][6] = 0;
	M[0][7] = 0;
	M[0][8] = 0;

	M[1][0] = c1;
	M[1][1] = -c1/4;
	M[1][2] = -c1/2;
	M[1][3] = c2;
	M[1][4] = -c2;
	M[1][5] = 0;
	M[1][6] = 0;
	M[1][7] = c3;
	M[1][8] = 0;

	M[2][0] = c1;
	M[2][1] = -c1/4;
	M[2][2] = -c1/2;
	M[2][3] = 0;
	M[2][4] = 0;
	M[2][5] = c2;
	M[2][6] = -c2;
	M[2][7] = -c3;
	M[2][8] = 0;

	M[3][0] = c1;
	M[3][1] = -c1/4;
	M[3][2] = -c1/2;
	M[3][3] = -c2;
	M[3][4] = c2;
	M[3][5] = 0;
	M[3][6] = 0;
	M[3][7] = c3;
	M[3][8] = 0;
	
	M[4][0] = c1;
	M[4][1] = -c1/4;
	M[4][2] = -c1/2;
	M[4][3] = 0;
	M[4][4] = 0;
	M[4][5] = -c2;
	M[4][6] = c2;
	M[4][7] = -c3;
	M[4][8] = 0;

	M[5][0] = c1;
	M[5][1] = c1/2;
	M[5][2] = c1/4;
	M[5][3] = c2;
	M[5][4] = c2/2;
	M[5][5] = c2;
	M[5][6] = c2/2;
	M[5][7] = 0;
	M[5][8] = c3;

	M[6][0] = c1;
	M[6][1] = c1/2;
	M[6][2] = c1/4;
	M[6][3] = -c2;
	M[6][4] = -c2/2;
	M[6][5] = c2;
	M[6][6] = c2/2;
	M[6][7] = 0;
	M[6][8] = -c3;

	M[7][0] = c1;
	M[7][1] = c1/2;
	M[7][2] = c1/4;
	M[7][3] = -c2;
	M[7][4] = -c2/2;
	M[7][5] = -c2;
	M[7][6] = -c2/2;
	M[7][7] = 0;
	M[7][8] = c3;

	M[8][0] = c1;
	M[8][1] = c1/2;
	M[8][2] = c1/4;
	M[8][3] = c2;
	M[8][4] = c2/2;
	M[8][5] = -c2;
	M[8][6] = -c2/2;
	M[8][7] = 0;
	M[8][8] = -c3;
	

    }

    return M;
    
}
